---
layout: default
title: How to install the web application
---

<div id="style"></div>
<script>
var platforms = new Array();
platforms[0] = "ubuntu";
platforms[1] = "mac";
platforms[2] = "windows";

function enable(name) {
	var s = "	<style type='text/css'>";

	for (var i in platforms) {
		var platform = platforms[i];
		if (name != platform) {
			s += "div.for"+platform+" { display: none; }\n";
			s += "pre.for"+platform+" { display: none; }\n";
			s += "span.for"+platform+" { display: none; }\n";
		}
	}

  s += "</style>";

  document.getElementById('style').innerHTML = s;
}
</script>

_Only show instructions for your platform: <a href="javascript: enable('ubuntu')">Ubuntu</a> <a href="javascript: enable('mac')">Mac</a> <a href="javascript: enable('windows')">Windows</a>_

h1. How to install the web application

This document goes over how we have set up the OpenAustralia web application on our development machines.

h2. Assumptions

For a server set up, you can use this as a base however it might require a different approach unless you have complete control (i.e. you are root) on the server and can install all the dependencies, secure the machine, etc. So, use these instructions as a starting point rather than a definitive "this is the ultimate way" step-by-step guide.

h2. Download

If you don't have the version control system "git":http://git.or.cz/ you'll need to install it.

Then:

<pre>
git clone git://github.com/mlandauer/openaustralia.git
cd openaustralia
git submodule init
git submodule update
</pre>

h2. Install the dependencies

We need the following bits and pieces

* Apache 
* PHP
* MySQL
* Perl (with a few CPAN modules)

(we've tested with Apache 2.X.X, PHP5, MySQL 5.0.x)

<div class="formac">

h3. Max OS X Leopard

Apache, PHP and Ruby all come with Leopard. If you need to install any of these
on Mac OS X (if for whatever reason you don't have them installed) there's a ton
of information online:

# "Entropy's Instructions":http://www.entropy.ch/software/macosx/
# "Hivelogic's Instructions":http://hivelogic.com/articles/ruby_rails_lighttpd_mysql_tiger/

You should also be able to get MySQL from "MySQL's website":http://www.mysql.com/ as they now distribute binary versions for Mac OS X (at the time of writing this document, you can find the 5.0.51a MySQL Community Server at "MySQL Community Server":http://dev.mysql.com/downloads/mysql/5.0.html#macosx-dmg).

As the parsing of XML files to insert into the database is done with Perl (and there's quite a few scripts in Perl), you will need a few Perl CPAN modules:

<pre>
sudo perl -MCPAN -e shell
cpan> install Error
cpan> install XML::Twig
cpan> install DBD::mysql
cpan> install XML::RSS
</pre>

</div>

<div class="forubuntu">

h3. Ubuntu 8.04

Use apt-get to install the requirements:

<pre>
sudo apt-get install apache2 php5 php5-cli mysql-server libmysqlclient15-dev php5-mysql liberror-perl libxml-twig-perl libdbd-mysql-perl libxml-rss-perl

# Enable the apache modules.
a2enmod php
a2enmod rewrite
</pre>

</div>

<div class="forwindows">

h3. Windows

Apache, PHP and MySQL can all be installed together with the "Xampp for Windows":http://www.apachefriends.org/en/xampp-windows.html package. Perl can be downloaded from ActiveState in the "ActivePerl":http://www.activestate.com/Products/activeperl/index.mhtml package.

h4. Perl

The x86 version of ActivePerl comes with a GUI for installing packages that makes the whole process a lot easier. Refer to http://aspn.activestate.com/ASPN/docs/ActivePerl/5.10/faq/ActivePerl-faq2.html for instructions on running it. ActivePerl comes with a lot of packages already installed but there are a few you'll need to install yourself, namely: XML-Twig, DBD-mysql and Error.

If DBD-mysql fails to install try installing it manually with

<pre>
ppm install http://cpan.uwinnipeg.ca/PPMPackages/10xx/DBD-mysql.ppd
</pre>

Reference "http://dev.mysql.com/doc/refman/5.0/en/activestate-perl.html":http://dev.mysql.com/doc/refman/5.0/en/activestate-perl.html (bottom of page).

</div>

h2. Putting the web application in the correct spot

For development purposes we have our web application and the parser under <span class="formac"><code>/Library/WebServer/Documents/</code> (Mac)</span> <span class="forubuntu"><code>/var/www/</code> (Ubuntu)</span> and, unless you want to patch the configuration too much, we recommend that you install it there.

Move the <code>openaustralia</code> directory that you previously downloaded to <span class="formac"><code>/Library/WebServer/Documents/</code> (Mac)</span> <span class="forubuntu"><code>/var/www/</code> (Ubuntu)</span>.

<pre class="formac">
# For Mac
mv openaustralia /Library/WebServer/Documents
</pre>

<pre class="forubuntu">
# For Ubuntu
mv openaustralia /var/www
</pre>

Fix the permissions, this is necessary so that you don't always have use sudo when editing files or coding on the website.

<pre class="formac">
# For Mac
sudo chown -R $USER:staff /Library/WebServer/Documents
</pre>

<pre class="forubuntu">
# For Ubuntu
chmod -R a+rX /var/www/openaustralia
</pre>


h2. MySQL

We now need to create a database in MySQL and load the schema. We assume that you have MySQL running and that your MySQL super user is <code>root</code> and the account has a password.

Step one. Create the database. This is pretty simple:

<pre>
mysqladmin -u root -p create openaustralia
Enter password: ******
</pre>

Step two. Import the schema:

<pre>
mysql -u root -p openaustralia < openaustralia/twfy/db/schema.sql
Enter password: ******
</pre>

h2. Apache

Next, configure your Apache server using the example configuration files in <code>openaustralia/twfy/conf/httpd.conf.*</code>.
The configurations are to setup a virtual host at "dev.openaustralia.org":http://dev.openaustralia.org.

You will also need to ensure <code>mod-rewrite</code> is enabled.

<div class="forubuntu">

h3. Ubuntu

<pre>
# in openaustralia/twfy/conf
cp general-example.ubuntu general
cp httpd.conf.ubuntu /etc/apache2/sites-available/
</pre>

</div>

<div class="formac">

h3. Mac

<pre>
# in openaustralia/twfy/conf
cp general-example.mac general
cat httpd.conf.mac >> /etc/apache2/extra/httpd-vhosts.conf
</pre>

</div>

Make sure that the name "dev.openaustralia.org":http://dev.openaustralia.org resolves to your localhost by doing the following:

<pre>
echo "127.0.0.1 dev.openaustralia.org" >> /etc/hosts
</pre>

Restart Apache to make your changes active:

<pre>
sudo apachectl restart
</pre>

h2. Configure the web application itself

<div class="formac">

<pre>
# On Mac
cp openaustralia/twfy/conf/general-example.mac openaustralia/twfy/conf/general
</pre>

</div>

<div class="forubuntu">

<pre>
# On Ubuntu
cp openaustralia/twfy/conf/general-example.ubuntu openaustralia/twfy/conf/general
</pre>

</div>

The configuration file <code>openaustralia/twfy/conf/general</code> is well documented and quite self-explanatory. It contains the configuration for MySQL (database name, host, username, etc) as well as the URL and paths for the web application on your machine.

h2. Look at the result

You should now be able to view the results at your webserver URL, "dev.openaustralia.org":http://dev.openaustralia.org

Hopefully, you should see a working version of openaustralia.org but without any data in it. This is because we haven't loaded anything into the database yet. This is what we're going to do next.

h2. Loading data into the database

There are two alternative approaches to this:

# Download XML data from "data.openaustralia.org":http://data.openaustralia.org
# _or_ setup and run the scraper / parser.

The first approach is very quick and straightforward and recommended if you are mostly interested in working on the web application.

The second approach is more time consuming but allows you to work with the scraper / parser and downloads the Hansard data from "www.aph.gov.au":http://www.aph.gov.au.

Next: follow the "install instructions for downloading XML data":download-xml-data.html _or_ follow the "install instructions for setting up the parser / scraper":install-parser.html
